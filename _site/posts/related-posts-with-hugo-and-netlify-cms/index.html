<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Hugues Tennier</title>

    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/_theme/theme.css">
    <link rel="stylesheet" type="text/css" href="/_theme/posts.css">
    
  </head>
  <body>

    <header class="main-header">
      <a href="#" class="logo">hugues.dev</a>
    </header>
    <main>
      <article class="articles">
        <h1>Related posts with <br>Hugo + Netlify CMS</h1>
<p><time>May 2nd, 2020</time></p>
<p>A good way to keep your users engaged is showing links to other relevant related content. It will keep your users longer on your websiteâ€¦</p>
<h2 id="good%3A-automatic-related-posts-with-hugo%E2%80%99s-related-content-built-in-methods"><a class="header-anchor" href="#good%3A-automatic-related-posts-with-hugo%E2%80%99s-related-content-built-in-methods">#</a> Good: Automatic related posts with Hugoâ€™s Related content built-in methods</h2>
<p>Hugo provide a <a href="https://gohugo.io/content-management/related/">.Related</a> method you can use to automatically show related posts to your blog article.</p>
<p>From their docs:</p>
<blockquote>
<p>Hugo uses a set of factors to identify a pageâ€™s related content based on Front Matter parameters.</p>
</blockquote>
<h2 id="better%3A-manually-choosing-your-related-posts-with-netlify-cms"><a class="header-anchor" href="#better%3A-manually-choosing-your-related-posts-with-netlify-cms">#</a> Better: Manually choosing your related posts with Netlify CMS</h2>
<p>Automation is great but when your blog gets bigger and bigger, most of the time you will want to choose your own related posts that are the most relevant to your blog article. Some nuance that the automatic algorithm might not pick up or a posts your specifically want to resurface.</p>
<h3 id="netlify-cms-relation-widget"><a class="header-anchor" href="#netlify-cms-relation-widget">#</a> Netlify CMS relation widget</h3>
<p><a href="https://www.netlifycms.org/docs/widgets/relation/">Netlify CMS relation widget</a> can do exactly what we want. From the docs:</p>
<blockquote>
<p>The relation widget allows you to reference items from another collection.</p>
</blockquote>
<p>We can setup the relation widget to search for different fields in your content files. Hereâ€™s a sample config using <code>title</code> as the search field and searching into my <code>blog</code> collection:</p>
<p>config.yml</p>
<pre class="language-yml"><code class="language-yml"><span class="token punctuation">-</span> <span class="token key atrule">label</span><span class="token punctuation">:</span> â€œRelated postsâ€<br>  <span class="token key atrule">name</span><span class="token punctuation">:</span> â€œrelatedpostsâ€<br>  <span class="token key atrule">widget</span><span class="token punctuation">:</span> â€œrelationâ€<br>  <span class="token key atrule">collection</span><span class="token punctuation">:</span> â€œblogâ€<br>  <span class="token key atrule">searchFields</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>â€œtitleâ€<span class="token punctuation">]</span><br>  <span class="token key atrule">valueField</span><span class="token punctuation">:</span> â€œtitleâ€<br>  <span class="token key atrule">multiple</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre>
<p>Hereâ€™s how it would look in the UI:</p>
<p>From there, in our Hugo template, we can loop over our related posts array:</p>
<pre class="language-html"><code class="language-html">{{ if .Params.relatedposts }}<br>  {{ range .Params.relatedposts }}<br>    {{ $title := . }}<br>    {{ range where $.Site.Pages â€œTitleâ€ $title }}<br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€”</span> <span class="token attr-name">Inside</span> <span class="token attr-name">the</span> <span class="token attr-name">range,</span> <span class="token attr-name">we</span> <span class="token attr-name">have</span> <span class="token attr-name">access</span> <span class="token attr-name">to</span> <span class="token attr-name">every</span> <span class="token attr-name">posts</span> <span class="token attr-name">.Params</span> <span class="token attr-name">â€”-</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>â€œrelated-postâ€</span><span class="token punctuation">></span></span><br>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>â€œ{{</span> <span class="token attr-name">.Permalink</span> <span class="token attr-name">}}â€</span><span class="token punctuation">></span></span>{{ .Title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>      by {{ .Params.author }} on {{ .Params.date }}<br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>{{ . Description }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span><br>    {{ end }}<br>  {{ end }}<br>{{ end }}</code></pre>
<h2 id="best%3A-why-not-both%3F"><a class="header-anchor" href="#best%3A-why-not-both%3F">#</a> Best: Why not both?</h2>
<p>Sometime you just want to write a quick article and not worry too much about related posts or you just want to resurface one post in particular. We can combine both Hugoâ€™s .Related and Netlify CMS relation widget using <code>.Scratch</code> to cover all different cases:</p>
<pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€”</span> <span class="token attr-name">This</span> <span class="token attr-name">variable</span> <span class="token attr-name">will</span> <span class="token attr-name">hold</span> <span class="token attr-name">our</span> <span class="token attr-name">related</span> <span class="token attr-name">posts</span> <span class="token attr-name">â€”</span><span class="token punctuation">></span></span><br>{{ $related := newScratch }}<br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€”</span> <span class="token attr-name">1.</span> <span class="token attr-name">Check</span> <span class="token attr-name">if</span> <span class="token attr-name">related</span> <span class="token attr-name">posts</span> <span class="token attr-name">are</span> <span class="token attr-name">set</span> <span class="token attr-name">through</span> <span class="token attr-name">the</span> <span class="token attr-name">CMS</span> <span class="token attr-name">â€”</span><span class="token punctuation">></span></span><br>{{ if .Params.relatedposts }}<br>  {{ range .Params.relatedposts }}<br>    {{ $title := . }}<br>    {{ range where $.Site.Pages â€œTitleâ€ $title }}<br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€”</span> <span class="token attr-name">We</span> <span class="token attr-name">use</span> <span class="token attr-name">`slice`</span> <span class="token attr-name">in</span> <span class="token attr-name">order</span> <span class="token attr-name">to</span> <span class="token attr-name">create</span> <span class="token attr-name">an</span> <span class="token attr-name">array</span> <span class="token attr-name">of</span> <span class="token attr-name">posts</span> <span class="token attr-name">â€”-</span><span class="token punctuation">></span></span><br>      {{ $related.Add â€œpostsâ€ (slice .) }}<br>    {{ end }}<br>  {{ end }}<br>{{ end }}<br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€”</span> <span class="token attr-name">2.</span> <span class="token attr-name">Use</span> <span class="token attr-name">Hugoâ€™s</span> <span class="token attr-name">built-in</span> <span class="token attr-name">method</span> <span class="token attr-name">.Related</span>  <span class="token attr-name">â€”</span><span class="token punctuation">></span></span><br>{{ $related.Add â€œpostsâ€ (.Site.RegularPages.Related . | first 2) }}<br><br><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>!â€”</span> <span class="token attr-name">Weâ€™re</span> <span class="token attr-name">using</span> <span class="token attr-name">`first</span> <span class="token attr-name">2`</span> <span class="token attr-name">filter</span> <span class="token attr-name">here</span> <span class="token attr-name">just</span> <span class="token attr-name">in</span> <span class="token attr-name">case</span> <span class="token attr-name">that</span> <span class="token attr-name">our</span> <span class="token attr-name">related</span> <span class="token attr-name">posts</span> <span class="token attr-name">array</span> <span class="token attr-name">contains</span> <span class="token attr-name">more</span> <span class="token attr-name">posts</span> <span class="token attr-name">than</span> <span class="token attr-name">what</span> <span class="token attr-name">we</span> <span class="token attr-name">want</span> <span class="token attr-name">to</span> <span class="token attr-name">show</span> <span class="token attr-name">in</span> <span class="token attr-name">our</span> <span class="token attr-name">UI.</span> <span class="token attr-name">We</span> <span class="token attr-name">can</span> <span class="token attr-name">safely</span> <span class="token attr-name">assume</span> <span class="token attr-name">it</span> <span class="token attr-name">will</span> <span class="token attr-name">always</span> <span class="token attr-name">only</span> <span class="token attr-name">show</span> <span class="token attr-name">two</span> <span class="token attr-name">posts.</span> <span class="token attr-name">â€”</span><span class="token punctuation">></span></span> <br>{{ with $related.Get â€œpostsâ€ | first 2 }}<br>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Related posts<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span><br>    {{ range . }}<br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span>â€œrelated-postâ€</span><span class="token punctuation">></span></span><br>          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation">=</span>â€œ{{</span> <span class="token attr-name">.Permalink</span> <span class="token attr-name">}}â€</span><span class="token punctuation">></span></span>{{ .Title }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><br>      by {{ .Params.author }} on {{ .Params.date }}<br>      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>{{ . Description }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><br>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">></span></span><br>    {{ end }}<br>{{ end }}</code></pre>
<p>If you write content using Hugo and Netlify CMS, this is a great way to resurface related posts and keep your user engaged.</p>

        <p class="articles-emojii">âœŒğŸ»</p>
        <div class="articles-author">
          I'm a self-taught front-end developer based in MontrÃ©al ğŸ‡¨ğŸ‡¦ currently working at <a href="https://www.netlify.com">Netlify</a>. I'm obsessed with user experience, accessibility and modern CSS techniques.
        </div>
      </article>
    </main>
    <footer>
      Â ğŸ–¤ Built with <a href="https://www.11ty.dev">11ty</a> and hosted on <a href="https://www.netlify.com">Netlify</a>
    </footer>
    
    

    <script src="/_theme/hugues.js"></script>
  </body>
</html>
